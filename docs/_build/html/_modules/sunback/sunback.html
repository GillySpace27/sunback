

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>sunback.sunback &mdash; SolarBackgroundUpdater  documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme2.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> SolarBackgroundUpdater
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../getting_started.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api.html">API Documentation</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">SolarBackgroundUpdater</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../index.html">Module code</a> &raquo;</li>
        
      <li>sunback.sunback</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <h1>Source code for sunback.sunback</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">sunback.py</span>
<span class="sd">A program that downloads the most current images of the sun from the SDO satellite, then finds the most likely temperature in each pixel. Then it sets each of the images to the desktop background in series. </span>

<span class="sd">Handles the primary functions</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">ctypes</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">import</span> <span class="nn">pathlib</span>

<span class="kn">from</span> <span class="nn">urllib.request</span> <span class="k">import</span> <span class="n">urlretrieve</span> <span class="k">as</span> <span class="n">urlret</span>
<span class="kn">from</span> <span class="nn">random</span> <span class="k">import</span> <span class="n">shuffle</span>
<span class="kn">import</span> <span class="nn">os.path</span> <span class="k">as</span> <span class="nn">path</span>

<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">ImageFont</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="k">import</span> <span class="n">ImageDraw</span>

<span class="kn">import</span> <span class="nn">pytesseract</span> <span class="k">as</span> <span class="nn">tes</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">mod</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="k">import</span> <span class="n">floor</span>

<span class="c1"># import aiaTemp_parallel as aia</span>

<span class="c1"># import sys, os</span>
<span class="kn">import</span> <span class="nn">sys</span>

<span class="n">sys</span><span class="o">.</span><span class="n">stderr</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;errlog.txt&quot;</span><span class="p">,</span> <span class="s2">&quot;w&quot;</span><span class="p">)</span>


<span class="c1"># Function Definitions</span>

<span class="k">def</span> <span class="nf">download_image</span><span class="p">(</span><span class="n">web_path</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="n">wave</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Download an image and save it to file</span>

<span class="sd">    Go to the internet and download an image</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    web_path : str</span>
<span class="sd">        The web location of the image repository</span>
<span class="sd">        </span>
<span class="sd">    local_path : str</span>
<span class="sd">        The local save location of the image</span>
<span class="sd">        </span>
<span class="sd">    wave : str</span>
<span class="sd">        The name of the desired image</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    success : bool</span>
<span class="sd">        0 if success</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Downloading Image...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="c1"># if wave[0] == &#39;t&#39;:</span>
    <span class="c1">#     try:</span>
    <span class="c1">#         aia.runParallel()</span>
    <span class="c1">#     except:</span>
    <span class="c1">#         try:</span>
    <span class="c1">#             aia.runParallel()</span>
    <span class="c1">#         except:</span>
    <span class="c1">#             print(&#39;Failed&#39;, flush=True)</span>
    <span class="c1">#             return 1</span>
    <span class="c1"># else:</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">urlret</span><span class="p">(</span><span class="n">web_path</span><span class="p">,</span> <span class="n">local_path</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">urlret</span><span class="p">(</span><span class="n">web_path</span><span class="p">,</span> <span class="n">local_path</span><span class="p">)</span>
        <span class="k">except</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Failed&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">);</span>
            <span class="k">return</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success&quot;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">update_background</span><span class="p">(</span><span class="n">local_path</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Update the system background&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="n">ctypes</span><span class="o">.</span><span class="n">windll</span><span class="o">.</span><span class="n">user32</span><span class="o">.</span><span class="n">SystemParametersInfoW</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="n">local_path</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Background Updated&quot;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed to update background&quot;</span><span class="p">);</span>
        <span class="k">raise</span>


<span class="k">def</span> <span class="nf">save_reference</span><span class="p">(</span><span class="n">pathToFile</span><span class="p">,</span> <span class="n">wave</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Grab a single reference image and save&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Saving Reference Image...&quot;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%y-%j-%H-%M&quot;</span><span class="p">)</span>
        <span class="n">webpath</span> <span class="o">=</span> <span class="s2">&quot;https://sdo.gsfc.nasa.gov/assets/img/latest/latest_2048_</span><span class="si">{}</span><span class="s2">.jpg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span>
        <span class="n">fullpath</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">pathToFile</span> <span class="o">+</span> <span class="s2">&quot;reference</span><span class="se">\\</span><span class="s2">171_reference_</span><span class="si">{}</span><span class="s2">.jpg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">now</span><span class="p">))</span>
        <span class="n">urlret</span><span class="p">(</span><span class="n">webpath</span><span class="p">,</span> <span class="n">fullpath</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success&quot;</span><span class="p">)</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Failed&quot;</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">imageMod</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">wave</span><span class="p">,</span> <span class="n">resolution</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Modify the image&quot;&quot;&quot;</span>
    <span class="k">try</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Modifying Image...&#39;</span><span class="p">,</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="c1"># Open the image for modification</span>
        <span class="n">img</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fullPath</span><span class="p">)</span>
        <span class="n">img_raw</span> <span class="o">=</span> <span class="n">img</span>
        <span class="n">font</span> <span class="o">=</span> <span class="n">ImageFont</span><span class="o">.</span><span class="n">truetype</span><span class="p">(</span><span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="s2">&quot;C:\Windows\Fonts\Arial.ttf&quot;</span><span class="p">),</span> <span class="mi">42</span><span class="p">)</span>

        <span class="c1"># Shrink the HMI images to be the same size</span>
        <span class="k">if</span> <span class="n">wave</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span>
            <span class="n">smallSize</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mf">0.84</span><span class="o">*</span><span class="n">resolution</span><span class="p">)</span> <span class="c1">#1725</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">smallSize</span><span class="p">)</span>
            <span class="n">old_img</span> <span class="o">=</span> <span class="n">img</span><span class="o">.</span><span class="n">resize</span><span class="p">((</span><span class="n">smallSize</span><span class="p">,</span> <span class="n">smallSize</span><span class="p">))</span>
            <span class="n">old_size</span> <span class="o">=</span> <span class="n">old_img</span><span class="o">.</span><span class="n">size</span>

            <span class="n">new_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
            <span class="n">new_im</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">,</span> <span class="n">new_size</span><span class="p">)</span>

            <span class="n">x</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">new_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">old_size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
            <span class="n">y</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">new_size</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">old_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>

            <span class="n">new_im</span><span class="o">.</span><span class="n">paste</span><span class="p">(</span><span class="n">old_img</span><span class="p">,</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">))</span>
            <span class="n">img</span> <span class="o">=</span> <span class="n">new_im</span>

        <span class="c1"># Read the time and reprint it</span>
        <span class="k">if</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span><span class="o">.</span><span class="n">tm_isdst</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">altzone</span> <span class="o">/</span> <span class="n">hours</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">offset</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">timezone</span> <span class="o">/</span> <span class="n">hours</span>

        <span class="c1"># try:</span>
        <span class="n">cropped</span> <span class="o">=</span> <span class="n">img_raw</span><span class="o">.</span><span class="n">crop</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1950</span><span class="p">,</span> <span class="mi">1024</span><span class="p">,</span> <span class="mi">2048</span><span class="p">))</span>

        <span class="c1"># cornerX = 218</span>
        <span class="c1"># cornerY = 970</span>
        <span class="c1"># widX = 1612</span>
        <span class="c1"># widY = 100</span>
        <span class="c1"># cropped2 = img_raw.crop((cornerX,cornerY, cornerX + widX, cornerY+widY))</span>
        <span class="c1"># cropped2.show()</span>

        <span class="n">results</span> <span class="o">=</span> <span class="n">tes</span><span class="o">.</span><span class="n">image_to_string</span><span class="p">(</span><span class="n">cropped</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">wave</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;H&#39;</span><span class="p">:</span>  <span class="c1"># HMI Data</span>
            <span class="n">imgTime</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">6</span><span class="p">:]</span>
            <span class="n">imgHour</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">imgTime</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">imgMin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">imgTime</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">4</span><span class="p">])</span>

        <span class="k">else</span><span class="p">:</span>  <span class="c1"># AIA Data</span>
            <span class="n">imgTime</span> <span class="o">=</span> <span class="n">results</span><span class="p">[</span><span class="o">-</span><span class="mi">11</span><span class="p">:</span><span class="o">-</span><span class="mi">6</span><span class="p">]</span>
            <span class="n">imgHour</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">imgTime</span><span class="p">[:</span><span class="mi">2</span><span class="p">])</span>
            <span class="n">imgMin</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">imgTime</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">:])</span>

        <span class="n">imgHour</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">mod</span><span class="p">(</span><span class="n">imgHour</span> <span class="o">-</span> <span class="n">offset</span><span class="p">,</span> <span class="mi">12</span><span class="p">))</span>
        <span class="n">pre</span> <span class="o">=</span> <span class="s1">&#39;&#39;</span>
    <span class="k">except</span><span class="p">:</span>
        <span class="n">imgHour</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span><span class="o">.</span><span class="n">tm_hour</span><span class="p">,</span> <span class="mi">12</span><span class="p">)</span>
        <span class="n">imgMin</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">localtime</span><span class="p">()</span><span class="o">.</span><span class="n">tm_min</span>
        <span class="n">pre</span> <span class="o">=</span> <span class="s1">&#39;x&#39;</span>

    <span class="k">if</span> <span class="n">imgHour</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="n">imgHour</span> <span class="o">=</span> <span class="mi">12</span>
    <span class="c1"># Draw on the image and save</span>
    <span class="n">draw</span> <span class="o">=</span> <span class="n">ImageDraw</span><span class="o">.</span><span class="n">Draw</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>

    <span class="c1"># Draw the wavelength</span>
    <span class="n">towrite</span> <span class="o">=</span> <span class="n">wave</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="k">if</span> <span class="n">wave</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;0&#39;</span> <span class="k">else</span> <span class="n">wave</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">1510</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="n">towrite</span><span class="p">,</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>

    <span class="c1"># Draw a scale Earth</span>
    <span class="n">cornerX</span> <span class="o">=</span> <span class="mi">1580</span>
    <span class="n">cornerY</span> <span class="o">=</span> <span class="mi">350</span>
    <span class="n">widX</span> <span class="o">=</span> <span class="mi">15</span>
    <span class="n">widY</span> <span class="o">=</span> <span class="n">widX</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">ellipse</span><span class="p">((</span><span class="n">cornerX</span><span class="p">,</span> <span class="n">cornerY</span><span class="p">,</span> <span class="n">cornerX</span> <span class="o">+</span> <span class="n">widX</span><span class="p">,</span> <span class="n">cornerY</span> <span class="o">+</span> <span class="n">widY</span><span class="p">),</span> <span class="n">fill</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">outline</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">)</span>

    <span class="c1"># Draw the Current Time</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">rectangle</span><span class="p">([(</span><span class="mi">450</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="p">(</span><span class="mi">560</span><span class="p">,</span> <span class="mi">200</span><span class="p">)],</span> <span class="n">fill</span><span class="o">=</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">450</span><span class="p">,</span> <span class="mi">150</span><span class="p">),</span> <span class="n">time</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%I:%M&quot;</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>

    <span class="c1"># Draw the Image Time</span>
    <span class="n">draw</span><span class="o">.</span><span class="n">text</span><span class="p">((</span><span class="mi">450</span><span class="p">,</span> <span class="mi">300</span><span class="p">),</span> <span class="s2">&quot;</span><span class="si">{:0&gt;2}</span><span class="s2">:</span><span class="si">{:0&gt;2}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">imgHour</span><span class="p">,</span> <span class="n">imgMin</span><span class="p">,</span> <span class="n">pre</span><span class="p">),</span> <span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span> <span class="n">font</span><span class="o">=</span><span class="n">font</span><span class="p">)</span>

    <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">fullPath</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Success&quot;</span><span class="p">)</span>
    <span class="c1"># except:</span>
    <span class="c1">#     print(&quot;Failed&quot;);</span>
    <span class="c1">#     return 1</span>
    <span class="k">return</span> <span class="mi">0</span>


<span class="k">def</span> <span class="nf">run</span><span class="p">():</span>
    <span class="c1"># ##Set up the variables</span>

    <span class="c1">#  Delay Time for Background Rotation</span>
    <span class="n">seconds</span> <span class="o">=</span> <span class="mi">1</span>
    <span class="n">minutes</span> <span class="o">=</span> <span class="mi">60</span>
    <span class="n">hours</span> <span class="o">=</span> <span class="n">minutes</span> <span class="o">*</span> <span class="mi">60</span>
    <span class="n">picChangeTime</span> <span class="o">=</span> <span class="mi">30</span> <span class="o">*</span> <span class="n">seconds</span>  <span class="c1"># 0.3 * minutes</span>
    <span class="n">longMultiple</span> <span class="o">=</span> <span class="mi">3</span>

    <span class="c1"># File Paths</span>
    <span class="n">pathToFile</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;C:\Users\chgi7364\Dropbox\Drive\Pictures\SunToday</span><span class="se">\\</span><span class="s2">&quot;</span>

    <span class="c1"># pathToFile = path.dirname(path.abspath(__file__)) + &quot;\Images\\&quot;</span>
    <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span><span class="p">(</span><span class="n">pathToFile</span><span class="p">)</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

    <span class="c1"># Wavelength Selection</span>

    <span class="n">resolution</span> <span class="o">=</span> <span class="mi">2048</span>
    <span class="n">webStringAIA</span> <span class="o">=</span> <span class="s2">&quot;https://sdo.gsfc.nasa.gov/assets/img/latest/latest_</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="s2">&quot;_</span><span class="si">{}</span><span class="s2">.jpg&quot;</span><span class="p">)</span>
    <span class="n">wavelengths</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;0171&#39;</span><span class="p">,</span> <span class="s1">&#39;0193&#39;</span><span class="p">,</span> <span class="s1">&#39;0211&#39;</span><span class="p">,</span> <span class="s1">&#39;0304&#39;</span><span class="p">,</span> <span class="s1">&#39;0131&#39;</span><span class="p">,</span> <span class="s1">&#39;0335&#39;</span><span class="p">,</span> <span class="s1">&#39;0094&#39;</span><span class="p">,</span> <span class="s1">&#39;HMIBC&#39;</span><span class="p">,</span> <span class="s1">&#39;HMIIF&#39;</span><span class="p">]</span>
    <span class="c1"># wavelengths = [&#39;0193&#39;, &#39;temp&#39;]</span>
    <span class="n">wavelengths</span><span class="o">.</span><span class="n">sort</span><span class="p">()</span>
    <span class="c1"># wavelengths.insert(0, &#39;temp&#39;)</span>

    <span class="n">webPaths</span> <span class="o">=</span> <span class="p">[</span><span class="n">webStringAIA</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wave</span><span class="p">)</span> <span class="k">for</span> <span class="n">wave</span> <span class="ow">in</span> <span class="n">wavelengths</span><span class="p">]</span>
    <span class="n">webPaths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;https://sdo.gsfc.nasa.gov/assets/img/latest/f_211_193_171pfss_</span><span class="si">{}</span><span class="s2">.jpg&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resolution</span><span class="p">))</span>
    <span class="n">wavelengths</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s2">&quot;PFSS&quot;</span><span class="p">)</span>

    <span class="n">fileEnd</span> <span class="o">=</span> <span class="s2">&quot;_Now.jpg&quot;</span>

    <span class="c1">##The Main Loop</span>

    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">Live SDO Background Updater </span><span class="se">\n</span><span class="s2">Written by Gilly</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Resolution: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">resolution</span><span class="p">))</span>

    <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>

        <span class="k">for</span> <span class="n">wave</span><span class="p">,</span> <span class="n">webPath</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">webPaths</span><span class="p">):</span>
            <span class="c1"># try:</span>
            <span class="c1"># Define the Image</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">wave</span><span class="p">))</span>
            <span class="n">fullPath</span> <span class="o">=</span> <span class="n">path</span><span class="o">.</span><span class="n">normpath</span><span class="p">(</span><span class="n">pathToFile</span> <span class="o">+</span> <span class="n">wave</span> <span class="o">+</span> <span class="n">fileEnd</span><span class="p">)</span>

            <span class="c1"># Download the Image</span>
            <span class="k">if</span> <span class="n">download_image</span><span class="p">(</span><span class="n">webPath</span><span class="p">,</span> <span class="n">fullPath</span><span class="p">,</span> <span class="n">wave</span><span class="p">):</span>
                <span class="k">continue</span>

            <span class="c1"># Modify the Image</span>
            <span class="k">if</span> <span class="n">imageMod</span><span class="p">(</span><span class="n">fullPath</span><span class="p">,</span> <span class="n">wave</span><span class="p">,</span> <span class="n">resolution</span><span class="p">):</span>
                <span class="k">pass</span>

            <span class="c1"># Update the Background</span>
            <span class="n">update_background</span><span class="p">(</span><span class="n">fullPath</span><span class="p">)</span>

            <span class="c1"># Wait for a bit</span>
            <span class="k">if</span> <span class="s1">&#39;temp&#39;</span> <span class="ow">in</span> <span class="n">wave</span><span class="p">:</span>
                <span class="n">change</span> <span class="o">=</span> <span class="n">longMultiple</span> <span class="o">*</span> <span class="n">picChangeTime</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">change</span> <span class="o">=</span> <span class="n">picChangeTime</span>

            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Waiting for </span><span class="si">{}</span><span class="s2"> seconds...&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">change</span><span class="p">),</span> <span class="n">end</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">,</span> <span class="n">flush</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">change</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="c1"># except (KeyboardInterrupt, SystemExit):</span>
            <span class="c1">#     print(&quot;Fine, I&#39;ll Stop.\n&quot;);</span>
            <span class="c1">#     raise</span>
            <span class="c1"># except:</span>
            <span class="c1">#     print(&quot;I failed&quot;)</span>

    <span class="c1"># save_reference(pathToFile, &#39;0211&#39;)</span>



<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="c1"># Do something if this file is invoked on its own</span>
    <span class="n">run</span><span class="p">()</span>


<div class="viewcode-block" id="canvas"><a class="viewcode-back" href="../../autosummary/sunback.canvas.html#sunback.canvas">[docs]</a><span class="k">def</span> <span class="nf">canvas</span><span class="p">(</span><span class="n">with_attribution</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Placeholder function to show example docstring (NumPy format)</span>

<span class="sd">    Replace this function and doc string for your own project</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    with_attribution : bool, Optional, default: True</span>
<span class="sd">        Set whether or not to display who the quote is from</span>

<span class="sd">    Returns</span>
<span class="sd">    -------</span>
<span class="sd">    quote : str</span>
<span class="sd">        Compiled string including quote and optional attribution</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">quote</span> <span class="o">=</span> <span class="s2">&quot;The code is but a canvas to our imagination.&quot;</span>
    <span class="k">if</span> <span class="n">with_attribution</span><span class="p">:</span>
        <span class="n">quote</span> <span class="o">+=</span> <span class="s2">&quot;</span><span class="se">\n\t</span><span class="s2">- Adapted from Henry David Thoreau&quot;</span>
    <span class="k">return</span> <span class="n">quote</span></div>
</pre></div>

           </div>
           
          </div>
          <footer>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2019, Chris Gilly. Project structure based on the Computational Molecular Science Python Cookiecutter version 1.1

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>